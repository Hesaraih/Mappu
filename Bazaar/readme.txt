Bazaar
・バザーをチェックするだけのツール

○利用は自己責任で

○Windower+WindowerHelper必須

○使い方
・WindowerHelper.dllを同じディレクトリに入れて立ち上げる
・メニューから必要に応じてPIDを選択(対称キャラがウィンドウテキストに表示)
・開始を押すとバザーチェック
・開始(wanted利用)は対象wantedに記載した品名と価格を比較してマッチした時に
  ダイアログ&コールサウンドを鳴らしバザーを開いたまま一時停止
・wanted.iniの設定方法はwanted.ini参照
・wantedフォルダ内*.iniの設定方法はwanted.iniと同じ
・バザー画面や装備画面で止まってしまったりする場合は設定を弄る
・各カラムクリックでソート
・色付け(wanted利用)にチェックしていると対象wantedの**_USE=1にしてある対象品名を色付け
・抽出(wanted利用)すると対象wantedの**_USE=1にしてある対象品名だけ抽出表示

○設定
・金額フィルターを利用する
    設定した金額以上の品物をリストに追加しない
・デフォルトで色付け(wanted利用)を行う
    起動時にメニューのリスト→色付け(wanted利用)をチェックする
・ブラックリスト(blist.ini)を利用する
    blist.iniに記載してあるPC名に「/c name」を送信しない
・リスト追加時に自動スクロールする
    実行中リストに追加する際、追加した項目まで自動スクロールさせる
・FFXIAHを利用する
    リストの右クリックメニューにてFFXIAHで対象品名を検索する
    ※品名をUTF8にエンコードしているので他サイトはたぶん指定できない
・/ta 「name」を発行する
    首振りヴァァンモード
・オフセット自動サーチを利用する
    オフセットを機械語のパターンから自動検索
    チェックしている場合はiniのNPCMAP、NOWSTA、BAZAARの記述は不要
    ※パターンが変更された場合は各オフセットを手動書換えのこと
・終了時ウィンドウの位置/幅を保存
    Bazaarの起動位置と幅を保存する
・終了時リストのカラム幅を保存
    名前、品名、価格、個数、備考のカラム幅を保存する
・最小キー間隔
    WindowerHelperでのキー送信間隔の最小値(Escキー及び/c name)
    画面が閉じない場合はこの間隔を大きい値にする
・更新待機時間
    バザー情報がメモリに展開されるまでの待機時間
    バザーを開いてからEnterキーを押すまでの時間もコレ
・再試行回数
    バザーを開いてから更新待機時間毎にチェックする最大回数
    再試行回数を超えた場合は次の対象へ
・抽出時は抽出した物だけを保存する
    メニューのリスト→抽出(wanted利用)を利用している時に保存を行った場合
    この項目にチェックがあった場合抽出した物だけを保存する
・チェック順番
    バザーをチェックする順番を設定
    0.08以前はID順
・バザー数毎の待機時間
    相手のログが気になる方向け
    リストに追加後に設定時間待機する

○仕様
・可視範囲内(約50Ym)でバザーしているキャラクターに/cを発行
・WindowerHelperでEnterキーを送信しバザー画面へ
・読込みをチェックしてリストビューに書出し
・既にリストに記載されていた場合はリストから削除してから追加

○更新履歴
・0.0.9.1
    待機時間の条件判定が一部間違っていたのを修正
・0.0.9.0
    スレッドを_beginthreadexに変更
    チェック順番を設定できるようにした
        IDと4方位から選択
        [NPC_MEM]にPOS_X=,POS_Z=を追加
        [SETTING]にORDER=を追加
    バザー数毎の待機時間を設定できるようにした
        相手のログが気になる方向け
        [SETTING]にWAIT_NUM05=,WAIT_NUM10=,WAIT_NUM20=,WAIT_NUM21=を追加
・0.0.8.0
    設定にオフセット自動サーチを利用するを追加
        ※保存を押してもオフセット値は保存されません
    COMを初期化するようにした
    設定に/ta 「name」を発行するを追加
        ※人が多すぎたり遠いと/taできない模様
    設定のFFXIAHを利用するが保存出来ていなかったのを修正
    設定のレイアウト変更
	csvを読込む時読込み専用ファイルで開くのチェックボックスを削除
・0.0.7.0
    位置大きさ取得APIをGetWindowRectからGetWindowPlacementに変更
        ※最小化や最大化で終了した時の位置が正しく取れていなかった
    MSVCR100.dllに依存していたのを変更
        ※実行ファイルが大きくなりますがMSVCR100.dllがインストールされていなくても動く
    HTMLで保存時<table>タグの</tr>が抜けていたのを修正
    wantedマッチ時のリスト更新間隔を調整
・0.0.6.1
    0.04での変更点をコマンド→選択キャラのバザーを開くに反映し忘れていたのを修正
    0.05で追加した金額カンマのバッファを初期化させるようにした
        ※色が切替わる場合があった
    抽出にチェックが合った時に開始した時リストが切替わっていなかった不具合を修正
・0.0.6.0
    自分自身を覗く場合があったのを修正
    開始(wanted利用)で該当時の一時停止動作を変更
        1アイテムずつ停止→1キャラずつ停止
・0.0.5.0
    csv読込み時一番下のアイテムが重複していたのを修正
    リストの価格にカンマを入れるようにした
    リストの価格と個数を右揃えに変更
    リストのヘッダーダブルクリック時のカラム幅自動調整に対応
・0.0.4.0
    抽出表示時、右クリックメニューが正しく動作していなかったのを修正
    htmlで保存時デフォルト拡張子がcsvになっていたのを修正
    htmlで保存時文字の書き換え0x0A(\n)⇒0x7C(|)を行わないようにした
    wanted切替えにおいてwantedフォルダ内*.iniを読込むようにした
    保存関連の設定を出来るようにした
        ツール→設定→抽出時の保存は抽出した物のみにする
            bazaar.iniの[SETTING]にEXTRACT_SAVE=1を追加
        ツール→設定→保存フォルダ名
            bazaar.iniの[SETTING]にDIR_SAVE=保存を追加
    右クリックメニューに品名をffxiahで検索を追加
        ツール→設定→FFXIAHを利用する
        ※FFXIAHで利用できない文字ではサーチに失敗します(石とか)
            bazaar.iniの[SETTING]に以下を追加
            USE_FFXIAH=0
            FFXIAH=http://jp.ffxiah.com/search/item?q=
・0.0.3.0
    保存時に現在時刻のデフォルトファイル名を付けるようにした
        例)2012年01月24日21:15→2012-01-24T2115
    リストを読込めるようにした
        メニュー→リスト→読込みでCSVファイルを読込み
        予めリストに記載のあるPCは追加しない
        保存時、読込み時で0x0A(\n)⇔0x7C(|)に書き換え
    wantedを切換えできるようにした
        メニュー→ツール→wanted切替えで切替えを行う
        切替えできるのはwanted.ini及びwantedフォルダのwanted_01.ini〜wanted_99.iniの100種
    抽出(wanted)を追加
        メニュー→リスト→抽出(wanted利用)で対象wantedの*_USE=1の品名だけを抽出する
        開始を押すと解除
        保存する時は抽出(wanted)にチェックがあるときは抽出済みの結果を保存
    ブラックリストを追加
        blist.iniにバザーをチェックしないPCを登録
        メニュー→ツール→設定でblist.iniを利用するかどうか設定する
        メニュー→ツール→blist.ini編集で対象の設定を行う
        開始毎にblist.iniを読込むので更新必要なし
        bazaar.iniの[SETTING]にBLACK_LIST=0を追加
・0.0.2.1
    ソート関連の修正
        上手くソートできていなかったのを修正
            ※シリアルな数値作成方法を変更
        数値の昇順降順が逆だったのを修正
        初期値の変更
            ※常に昇順から始めるようにした
        実行した時ソートを情報をクリアするようにした
    メニューのマスク処理順番を一部変更
・0.0.2.0
    設定で「デフォルトで色付け〜」、「終了時〜」x2の3つが更新及び保存出来ていなかった不具合を修正
    実行中にリストを操作出来るようにした
        実行中はソート不能
    設定に「リスト追加時に自動スクロールする」を追加
        ※実行中リストに追加する時、追加した項目までスクロールさせる機能
        bazaar.iniの[SETTING]にAUTO_SCROLL=0を追加
    エラー防止処理を強化
・0.0.1.0を公開
・α2版を公開
・α版を公開